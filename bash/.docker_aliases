#!/bin/sh
docker_alias() {
    key="$1"
    case $key in
        bd)
            cmd='build'
            shift;;
        ex)
            cmd='exec -uroot -it'
            shift;;
        im)
            cmd='images'
            shift;;
        killall)
            cmd="kill $('docker' ps -q)"
            shift;;
        lg)
            cmd="logs"
            shift;;
        lgf)
            cmd='logs -f'
            shift;;
        lgft)
            # --tail="all" by default
            cmd='logs -f --tail=0'
            shift;;
        ps)
            cmd='ps --format table{{.ID}}\t{{.Image}}\t{{.Names}}\t{{.RunningFor}}\t{{.Ports}}'
            shift;;
        rmall)
            cmd="rm $('docker' ps -aq)"
            shift;;
        *)
            cmd=$1
            shift;;
    esac
    docker $cmd $@
}

docker_compose_alias() {
    key="$1"
    case $key in
        d)
            cmd='down'
            shift;;
        k)
            cmd='kill'
            shift;;
        lgf)
            cmd='logs -f'
            shift;;
        lgft)
            # --tail="all" by default
            cmd='logs -f --tail=0'
            shift;;
        pl)
            cmd='pull'
            shift;;
        r)
            cmd="run"
            shift;;
        rnd)
            cmd="run --no-deps --name $2"
            shift;;
        rs)
            cmd="restart"
            shift;;
        u)
            cmd='up'
            shift;;
        ur)
            # Restart a single service. Different from restart in the
            # way that if a service in the docker-compose file has been
            # changed, it will be restarted with the new changes.
            cmd='up -d --no-deps --force-recreate'
            shift;;
        *)
            cmd=$1
            shift;;
    esac
    docker-compose $cmd $@
}

alias docker='docker_alias'
alias docker-compose='docker_compose_alias'
