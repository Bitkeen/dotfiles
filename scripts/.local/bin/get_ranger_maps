#!/bin/sh
# Generate mappings for ranger.
#
# Arguments:
# $1 - input file that contains shortcuts mapped to directories
# $2 - output file that should be sourced in ranger's rc.conf
#
# The following line in the input file:
# .d ~/.dotfiles
# Will mapped in the following way:
# map <C-g>.d cd ~/.dotfiles
# map <C-t>.d tab_new ~/.dotfiles

if [ -z "$1" ]; then
    shortcuts="$HOME/.config/shortcuts"
else
    shortcuts="$1"
fi

if [ -z "$1" ]; then
    bookmarks="$HOME/.config/ranger/bookmark_maps.conf"
else
    bookmarks="$2"
fi

# Remove blank line at the end of the file with the `sed` command.
awk '{print "map <C-g>"$1" cd "$2"\nmap <C-t>"$1" tab_new "$2"\nmap <C-x>"$1" shell mv %s "$2"\n"}' \
    < "$shortcuts" | sed '${/^$/d;}' > "$bookmarks"
